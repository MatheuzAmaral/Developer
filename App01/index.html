<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Agendamento - Sal√£o Feminino</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #fce4ec, #f8bbd0);
      color: #333;
      padding-top: 80px;
    }

    .topbar {
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
    }

    .creator-bar {
      background-color: #c2185b;
      text-align: center;
      color: white;
      padding: 4px 0;
      font-size: 14px;
    }

    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: #e91e63;
      color: white;
    }

    .navbar h1 {
      font-size: 20px;
      margin: 0;
    }

    .menu-btn {
      font-size: 22px;
      cursor: pointer;
    }

    .sidebar {
      position: fixed;
      top: 0;
      left: -250px;
      width: 250px;
      height: 100%;
      background-color: #f8bbd0;
      padding: 60px 20px 20px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.3);
      transition: 0.3s;
      z-index: 999;
    }

    .sidebar.active {
      left: 0;
    }

    .sidebar input[type="password"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border: none;
      border-radius: 5px;
    }

    .sidebar button {
      width: 100%;
      padding: 10px;
      background-color: #e91e63;
      border: none;
      color: white;
      font-weight: bold;
      cursor: pointer;
      border-radius: 5px;
    }

    .container {
      max-width: 400px;
      margin: auto;
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-top: 10px;
    }

    input, select, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    button.confirmar {
      background-color: #e91e63;
      color: white;
      border: none;
      margin-top: 15px;
      cursor: pointer;
    }

    button.confirmar:hover {
      background-color: #c2185b;
    }

    .mensagem {
      margin-top: 15px;
      background: #fff0f5;
      padding: 10px;
      border-radius: 5px;
      display: none;
    }

    .admin-panel {
      max-width: 600px;
      margin: 40px auto;
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      display: none;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: left;
    }

    @media (max-width: 600px) {
      .container, .admin-panel {
        margin: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="creator-bar">Criado por: MatheuzSilperTec</div>
    <div class="navbar">
      <h1>Agendamento</h1>
      <i class="fas fa-bars menu-btn" onclick="toggleSidebar()"></i>
    </div>
  </div>

  <div class="sidebar" id="sidebar">
    <input type="password" id="senhaAdmin" placeholder="Senha do Admin">
    <button onclick="verificarSenha()">Entrar</button>
  </div>

  <div class="container">
    <label for="nome">Nome:</label>
    <input type="text" id="nome" required>

    <label for="servico">Servi√ßo:</label>
    <select id="servico" onchange="mostrarValor()">
      <option value="Escova simples">Escova simples</option>
      <option value="Hidrata√ß√£o capilar">Hidrata√ß√£o capilar</option>
      <option value="Corte feminino">Corte feminino</option>
      <option value="Progressiva">Progressiva</option>
      <option value="Luzes">Luzes</option>
      <option value="Colora√ß√£o">Colora√ß√£o</option>
      <option value="Sobrancelha">Sobrancelha</option>
      <option value="Maquiagem">Maquiagem</option>
      <option value="Manicure e pedicure">Manicure e pedicure</option>
      <option value="Spa dos p√©s">Spa dos p√©s</option>
    </select>

    <div id="valorServico" style="margin-top: 10px; font-weight: bold;"></div>

    <label for="data">Data:</label>
    <input type="date" id="data" onchange="atualizarHorarios()">

    <label for="hora">Hor√°rio:</label>
    <select id="hora"></select>

    <button class="confirmar" onclick="agendarEEnviar()">Confirmar e Enviar no WhatsApp</button>

    <div class="mensagem" id="mensagem"></div>
  </div>

  <div class="admin-panel" id="painelAdmin">
    <h2>Agendamentos</h2>
    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>Servi√ßo</th>
          <th>Data</th>
          <th>Hora</th>
        </tr>
      </thead>
      <tbody id="tabelaAgendamentos"></tbody>
    </table>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBdnwdXqkpxJ6Rq5kviUC8Dgt6BaPsBsLQ",
      authDomain: "agendamento---salao-feminino.firebaseapp.com",
      databaseURL: "https://agendamento---salao-feminino-default-rtdb.firebaseio.com",
      projectId: "agendamento---salao-feminino",
      storageBucket: "agendamento---salao-feminino.appspot.com",
      messagingSenderId: "187999443888",
      appId: "1:187999443888:web:cb7db27ae843267bfb5475",
      measurementId: "G-333PWHXDMB"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const precos = {
      "Escova simples": 40,
      "Hidrata√ß√£o capilar": 70,
      "Corte feminino": 50,
      "Progressiva": 200,
      "Luzes": 250,
      "Colora√ß√£o": 120,
      "Sobrancelha": 25,
      "Maquiagem": 100,
      "Manicure e pedicure": 60,
      "Spa dos p√©s": 80
    };

    const senhaCorreta = "1234";

    function toggleSidebar() {
      document.getElementById("sidebar").classList.toggle("active");
    }

    function mostrarValor() {
      const servico = document.getElementById("servico").value;
      document.getElementById("valorServico").textContent = `Valor: R$ ${precos[servico].toFixed(2).replace(".", ",")}`;
    }

    function atualizarHorarios() {
      const data = document.getElementById("data").value;
      const horaSelect = document.getElementById("hora");
      horaSelect.innerHTML = "";

      const ref = db.ref("agendamentos");
      ref.once("value", snapshot => {
        const agendados = [];
        snapshot.forEach(child => {
          if (child.val().data === data) {
            agendados.push(child.val().hora);
          }
        });

        for (let h = 9; h < 18; h++) {
          const horaStr = `${String(h).padStart(2, '0')}:00`;
          if (!agendados.includes(horaStr)) {
            const opt = document.createElement("option");
            opt.value = horaStr;
            opt.textContent = horaStr;
            horaSelect.appendChild(opt);
          }
        }

        if (!horaSelect.firstChild) {
          const opt = document.createElement("option");
          opt.textContent = "Sem hor√°rios dispon√≠veis";
          opt.disabled = true;
          horaSelect.appendChild(opt);
        }
      });
    }

    function agendarEEnviar() {
      const nome = document.getElementById("nome").value;
      const servico = document.getElementById("servico").value;
      const data = document.getElementById("data").value;
      const hora = document.getElementById("hora").value;

      if (nome && servico && data && hora) {
        const ref = db.ref("agendamentos");
        ref.push({ nome, servico, data, hora });

        const preco = precos[servico].toFixed(2).replace('.', ',');
        const mensagem = `üëã Ol√°, meu nome √© ${nome}!\n\nGostaria de agendar:\nüíá‚Äç‚ôÄÔ∏è ${servico}\nüìÖ ${data}\n‚è∞ ${hora}\nüí∞ R$ ${preco}`;
        const numero = "5591999999999";
        const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensagem)}`;
        window.open(url, '_blank');

        document.getElementById("mensagem").textContent = "Agendamento confirmado!";
        document.getElementById("mensagem").style.display = "block";

        atualizarHorarios();
      }
    }

    function verificarSenha() {
      const senha = document.getElementById("senhaAdmin").value;
      if (senha === senhaCorreta) {
        mostrarAgendamentos();
        toggleSidebar();
      } else {
        alert("Senha incorreta!");
      }
    }

    function mostrarAgendamentos() {
      const painel = document.getElementById("painelAdmin");
      const tabela = document.getElementById("tabelaAgendamentos");
      tabela.innerHTML = "";

      const ref = db.ref("agendamentos");
      ref.once("value", snapshot => {
        snapshot.forEach(child => {
          const ag = child.val();
          const row = tabela.insertRow();
          row.innerHTML = `<td>${ag.nome}</td><td>${ag.servico}</td><td>${ag.data}</td><td>${ag.hora}</td>`;
        });
        painel.style.display = "block";
      });
    }

    window.onload = () => {
      const hoje = new Date().toISOString().split("T")[0];
      document.getElementById("data").setAttribute("min", hoje);
      mostrarValor();
    };
  </script>
</body>
</html>
